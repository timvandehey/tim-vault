[implementation doc](https://docs.google.com/document/d/1FaIcn0iJn959nn1W-iRzmmMR_NFn8TteWTVziyYQN9c/edit?tab=t.0)

